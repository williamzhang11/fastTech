# MySQL事务日志undo log和redo log分析

这两事务日志用来保证事务原子性、持久性的，undo log(回滚日志)提供回滚操作，保证原子性，
redo log(重做日志)提供前滚操作，保证持久性

数据修改前，undo log会备份保存修改前的数据记录，然后把undo log写磁盘，数据修改并写磁盘，然后事务提交。

redo log记录数据修改后新数据的备份、冗杂的undo log、未提交的事务和回滚的事务，数据缓存到内存中，
只是在事务提交前将redo log持久化到磁盘

A.事务开始.
B.记录A=1到undo log.
C.修改A=3.
D.记录A=3到redo log.
E.记录B=2到undo log.
F.修改B=4.
G.记录B=4到redo log.
H.将redo log写入磁盘。
I.事务提交

记录undo日志，修改数据，记录redo log，持久化redo log，事务提交。

redo log先于数据持久化，数据不会在事务提交前写磁盘而是缓存起来。

如果发生错误，数据库系统在重启时会加载redo log找出未被更新到数据库磁盘中的日志重新执行以满足事务的持久性
（即对所有已提交的事务重做）


binlog是MySQL Server层记录的日志， redo log是InnoDB存储引擎层的日志。 两者都是记录了某些操作的日志
(不是所有)自然有些重复（但两者记录的格式不同）。

binlog日志用于记录所有更新且提交了数据或者已经潜在更新提交了数据（例如，没有匹配任何行的一个DELETE）的所
有语句。语句以“事件”的形式保存，它描述数据更改。



